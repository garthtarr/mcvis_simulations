---
title: "consumption"
author: "Kevin Wang"
date: "Jan 2020"
output: html_document
---

```{r}
library(perturb)
library(tidyverse)
library(ggcorrplot)
library(car)
library(mcvis)


data(consumption)
X = consumption[,-1]
year = X[,1]
year = year[-28]
X=cbind(X[-1,],year)

glimpse(X)

ggcorrplot(cor(X), 
          type = "upper",
           outline.col = "white",
          lab = TRUE, 
          lab_size = 8, 
          tl.cex = 20)
```


# Scatter plot 
```{r}
png(file = "figures/Fig5.png", width = 500, height = 500)
pairs(X, lower.panel = CPOP::panel_cor)
dev.off()
```


# VIF
```{r}
vif(lm(cons ~ ., data=consumption))
```


# mcvis

```{r}
set.seed(1)
mcvis_result = mcvis(X = X[,-1], standardise_method = "studentise")
mcvis_result$MC


png(file = "figures/Fig3.png", width = 500, height = 400)
mcvis::igraph_mcvis(mcvis_result)
dev.off()

mcvis::igraph_mcvis(mcvis_result)
mcvis::ggplot_mcvis(mcvis_result)
```


# Session info 
```{r}
sessionInfo()
```

