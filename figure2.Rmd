---
title: "Figure 2"
author: "Kevin Wang"
date: "29/06/2019"
output: html_document
---

```{r}
library(mcvis)
```


# Figure 2

```{r}
set.seed(315)

n = 200
gamma = 0.5
p = 4

w = matrix(rnorm(p*n,10,100),n,p)
x = sqrt(1-gamma^2)*w + gamma*w[,p]
z = apply(x, 2, function(col){
  res = (col - mean(col))/sd(col)
  # tmp = col - mean(col)
  # res = tmp/sqrt(sum(tmp^2))
  return(res)
})
apply(z, 2, mean)
apply(z, 2, var)
ztz_inv = solve(t(z) %*% z)
(vif = diag(ztz_inv))
svd_obj = svd(ztz_inv)
(taus = svd_obj$d)
(svd_obj$u^2 %*% taus) ## Equal to vif by theory



colnames(z) = paste0("x", 1:p)
png(file = "figures/Fig2.png", width = 350, height = 400)
mcvis::igraph_mcvis(mcvis::mcvis(X = z))
dev.off()
```


```{r}
sessionInfo()
```

